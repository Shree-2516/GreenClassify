<!DOCTYPE html>
<html lang="en" class="{% if prediction or image_path %}no-smooth{% endif %}">
<head>
    <meta charset="UTF-8">
    <title>GreenClassify</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="logo">ðŸŒ¿ GreenClassify</div>
    <div class="links">
        <a href="#home">Home</a>
        <a href="#about">About</a>
        <a href="#predict">Prediction</a>
    </div>
</nav>

<!-- HOME SECTION -->
<section id="home" class="section hero">
    <h1>Vegetable Image Classification</h1>
    <p>Upload an image and identify vegetables using deep learning.</p>
    <a href="#predict" class="btn">Start Prediction</a>
</section>

<!-- ABOUT SECTION -->
<section id="about" class="section light">
    <div class="card">
        <h2>About Us</h2>
        <p>
            GreenClassify is a deep learning based vegetable image
            classification system using CNN models.  
            It helps identify vegetables from images accurately and efficiently.
        </p>

        <h3>Contact</h3>
        <p>Email: support@greenclassify.com</p>
    </div>
</section>

<!-- PREDICTION SECTION -->
<section id="predict" class="section">
    <div class="card {% if image_path or prediction %}wide{% endif %}">
        <h2>Upload Vegetable Image</h2>

        <div class="pred-wrap {% if image_path or prediction %}two-column{% endif %}">

            <div class="col upload-col">
                <form method="POST"
                      enctype="multipart/form-data"
                      action="{{ url_for('index') }}#predict"
                      onsubmit="showLoader()">

                    <!-- Upload box -->
                    <div class="upload-box">
                        <input type="file" name="file" id="fileInput" accept="image/*" required hidden>

                        <label for="fileInput" class="upload-btn">Choose Image</label>

                        <p class="file-name" id="fileName">{% if image_path %}{{ image_path.split('/')[-1] }}{% else %}No file selected{% endif %}</p>

                        <!-- Preview before predict -->
                        <img id="localPreview" class="preview-small {% if not image_path %}hidden{% endif %}" {% if image_path %}src="{{ image_path }}"{% endif %}>
                    </div>

                    <br>

                    <button type="submit" class="btn" id="predictBtn">
                        <span id="btnText">Predict</span>
                        <span class="spinner" id="spinner"></span>
                    </button>
                </form>
            </div>

            <div class="col result-col">
                {% if image_path %}
                    <img src="{{ image_path }}" class="preview hover-image">
                {% endif %}

                {% if prediction %}
                    <h3>Vegetable is: <span>{{ prediction }}</span></h3>
                {% endif %}
            </div>

        </div>
    </div>
</section>

<script>
function showLoader() {
    document.getElementById("btnText").innerText = "Predicting...";
    document.getElementById("spinner").style.display = "inline-block";
    document.getElementById("predictBtn").classList.add("loading");
}

/* Preview selected image */
const fileInput = document.getElementById("fileInput");
const fileName = document.getElementById("fileName");
const preview = document.getElementById("localPreview");

fileInput.addEventListener("change", function () {
    const file = this.files[0];
    if (file) {
        fileName.innerText = file.name;
        const reader = new FileReader();
        reader.onload = e => {
            preview.src = e.target.result;
            preview.style.display = "block";
        };
        reader.readAsDataURL(file);
    } else {
        fileName.innerText = "No file selected";
        preview.style.display = "none";
    }
});
</script>

</body>
</html>